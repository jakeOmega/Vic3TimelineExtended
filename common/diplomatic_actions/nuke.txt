nuke_diplo_action = {
    groups= {
		general
	}
	requires_approval = no

	state_selection = second_required
    second_state_list = second_country
	
	show_confirmation_box = yes

	possible = {
        has_variable = nuclear_weapon_stockpile
        var:nuclear_weapon_stockpile > 0
        OR = {
            NOT = {
                OR = {
                    has_law = law_type:law_humanitarian_regulations
                    has_law = law_type:law_limited_war
                }
            }
            any_scope_state = {
                OR = {
                    has_modifier = nuclear_strike_aftermath
                    has_modifier = tactical_nuke_aftermath
                }
            }
        }
    }

	second_state_trigger = {
        owner = {
            has_war_with = scope:country
        }
    }
    
	accept_effect = {
        save_scope_as = attacking_country
        random_list = {
            0 = {
                modifier = nuclear_strike_success_chance
                nuclear_industrial_strike = yes
                scope:target_country = {
                    trigger_event = nuclear_weapon_events.1
                    change_relations = {
                        country = ROOT
                        value = -100  
                    }
                }
                trigger_event = nuclear_weapon_events.2
                post_notification = industrial_nuke_succeeds_attacker
            }
            0 = {
                modifier = nuclear_strike_fail_chance
                change_infamy = 5
                scope:target_country = {
                    trigger_event = nuclear_weapon_events.3
                    change_relations = {
                        country = ROOT
                        value = -10  
                    }
                }
                trigger_event = nuclear_weapon_events.4
            }
        }
    }

	is_hostile = yes

    ai = {
		evaluation_chance = {
            value = 100
        }

		will_select_as_second_state = {
            always = yes
        }
	
		will_propose = {
            any_scope_state = {
                has_modifier = nuclear_strike_aftermath
            }
            NOT = { infamy > 75 }
        }

		propose_score = {
            value = 0
            scope:second_state = {
                add = {
                    value = state_population
                    divide = owner.total_population
                }
                add = {
                    value = gdp
                    divide = owner.gdp
                }
                if = {
                    limit = {
                        is_incorporated = no
                    }
                    multiply = 0.5
                }
                if = {
                    limit = {
                        is_capital = yes
                    }
                    multiply = 2
                }
                multiply = owner.gdp
                divide = 100000 # 100,000
            }
        }
	}
}