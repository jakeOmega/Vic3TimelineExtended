on_monthly_pulse_state = {
	on_actions = {
		space_elevator_on_action
		remove_or_create_homelands_on_action
	}
}

on_monthly_pulse_country = {
	on_actions = {
		ministry_of_thought_control_on_action
		remove_invalid_buildings
		cheaty_on_action
		civil_rights_on_action
		change_culture_acceptance_on_action
	}
}

on_acquired_technology = {
	on_actions = {
		civil_rights_on_action
	}
}

space_elevator_on_action = {
	effect = {
		if = {
			limit = {
				has_building = building_space_elevator_construction_site
			}
			space_elevator_construction = yes
			every_scope_building = {
				limit = {
					is_building_type = building_space_elevator_construction_site
				}
				remove_modifier = space_elevator_progress
				add_modifier = {
					name = space_elevator_progress
					multiplier = this.var:space_elevator_progress_var
				}
			}
		}
	}
}

ministry_of_thought_control_on_action = {
	effect = {
		thought_control_loyalists_update = yes
	}
}

remove_invalid_buildings = {
	effect = {
		every_scope_state = {
			limit = {
				AND = {
					NOT = { owner.market_capital = THIS }
					has_building = building_space_program
				}
			}
			remove_building = building_space_program
		}
	}
}

cheaty_on_action = {
	effect = {
		if = {
			limit = {
				always = no
			}
			if = {
				limit = { NOT = { has_modifier = cheaty }}
				add_modifier = {
					name = cheaty
				}
			}
		}
		else_if = {
			limit = {
				has_modifier = cheaty
			}
			remove_modifier = cheaty
		}
	}
}

remove_or_create_homelands_on_action = {
	effect = {
		if = {
			limit = {
				owner = {
					power_bloc ?= {
						has_identity = identity:identity_cultural
					}
				}
			}
			every_scope_culture = {
				limit = {
					ROOT = {
						culture_percent_state = {
							target = PREV
							value < homeland_culture_disappear_threshold
						}
					}
					NOT = { is_primary_culture_of = ROOT.owner }
				}
				save_scope_as = removal_culture
				ROOT = {
					state_region = {
						remove_homeland = scope:removal_culture
					}
				}
			}
			every_scope_culture = {
				limit = {
					ROOT = {
						culture_percent_state = {
							target = PREV
							value >= homeland_culture_form_threshold
						}
					}
					is_primary_culture_of = ROOT.owner
				}
				save_scope_as = form_culture
				ROOT = {
					state_region = {
						add_homeland = scope:form_culture
					}
				}
			}
		}
	}
}

civil_rights_on_action = {
	effect = {
		if = {
			limit = { has_technology_researched = civil_rights_movement }
			ig:ig_intelligentsia = {
				
				add_ideology = ideology_multicultural
			}
		}
	}
}
